units           real
atom_style      full
boundary        p p p
box             tilt large
comm_style      tiled 
pair_style      lj/cut/coul/long 14.0 14.0 
pair_modify     mix geometric
special_bonds   lj 0 0 0.5 coul 0 0 0.5
bond_style      harmonic
angle_style     harmonic
dihedral_style  opls
improper_style  cvff
#read_restart    restart.1
read_data       lmp.data
neighbor        2.0 bin
neigh_modify    delay 0
kspace_style    pppm 1e-6
kspace_modify   order 4 
variable    T equal 180.0       # run temperature
variable    V equal vol
variable    dt equal 1.0
variable    p equal 400     # correlation length
variable    s equal 5       # sample interval
variable    d equal $p*$s   # dump interval

# convert from LAMMPS real units to SI

variable    kB equal 1.3806504e-23    # [J/K] Boltzmann
variable    atm2Pa equal 101325.0
variable    kCal2J equal 4186.0/6.02214e23
variable    A2m equal 1.0e-10
variable    fs2s equal 1.0e-15
variable    convert equal ${atm2Pa}*${atm2Pa}*${fs2s}*${A2m}*${A2m}*${A2m}
variable    convert2 equal ${kCal2J}*${kCal2J}/${fs2s}/${A2m}



thermo_style    custom step temp press density vol
thermo       $d
thermo_modify   norm yes

minimize 1.0e-5 1.0e-7 100000 400000


write_data   system_after_eq1_min.data


timestep        1.0
dump dumpeq2 all custom 100 traj_eq2_reorient.lammpstrj id mol type x y z ix iy iz


fix fxnvt all nvt temp 180.0 180.0 100.0
run             1000000
undump dumpeq2
write_data   system_after_eq2_reorient.data
unfix fxnvt


variable dens equal density
fix densave all ave/time 100 1 100 v_dens file density_equilibration180.dat
dump dumpeq3 all custom 500 traj_eq3_npt.lammpstrj id mol type x y z ix iy iz
fix fxnpt all npt temp 180.0 180.0 100.0 iso 500.0 1.0 10000.0 

timestep        1.0
run             1000000
unfix densave



unfix fxnpt

undump dumpeq3

dump            dumpprod1 all custom 1000 r32.dump id type x y z vx vy vz ix iy iz
dump dumpprod2 all xyz 1000 r32.xyz

timestep        1.0

fix fxnpt all npt temp 180.0 180.0 100.0 iso 1.0 1.0 10000.0 

fix densave all ave/time 100 1 100 v_dens file density_production180.dat

run             1000000
variable enthal equal enthalpy
fix ensave all ave/time 1 1 1 v_enthal file enthalpy.dat
run             100000
unfix ensave
unfix fxnpt
#unfix densave
undump dumpprod1
undump dumpprod2


#write_data   system_after_eq3_npt.data






#fix fxnvt2 all nvt temp 180.0 180.0 100.0
#run            3000000
#unfix fxnvt2


		  
#fix       nveall 	all 	 	 	nve

#reset_timestep 0
#dump            dumpprod3 all dcd 1000 production.dcd
#dump_modify     dumpprod3 unwrap yes
#dump            dumpprod4 all xtc 1000 production.xtc
#viscosity calculation
#variable     pxy equal pxy
#variable     pxz equal pxz
#variable     pyz equal pyz
#fix          SS all ave/correlate $s $p $d &
#             v_pxy v_pxz v_pyz type auto file S0St.dat ave running
#fix myat2 all ave/time 1 1 1 v_pxy v_pxz v_pyz  &
#    file stress.dat
#variable     scale equal ${convert}/(${kB}*$T)*$V*$s*${dt}
#variable     v11 equal trap(f_SS[3])*${scale}
#variable     v22 equal trap(f_SS[4])*${scale}
#variable     v33 equal trap(f_SS[5])*${scale}

#thermal conductivity calculation
#compute      myKE all ke/atom
#compute      myPE all pe/atom
#compute      myStress all stress/atom NULL virial
#compute      flux all heat/flux myKE myPE myStress
#variable     Jx equal c_flux[1]/vol
#variable     Jy equal c_flux[2]/vol
#variable     Jz equal c_flux[3]/vol
#fix          JJ all ave/correlate $s $p $d &
             c_flux[1] c_flux[2] c_flux[3] type auto file J0Jt.dat ave running
#variable     scale2 equal ${convert2}/${kB}/$T/$T/$V*$s*${dt}
#variable     k11 equal trap(f_JJ[3])*${scale2}
#variable     k22 equal trap(f_JJ[4])*${scale2}
#variable     k33 equal trap(f_JJ[5])*${scale2}

#thermo_style custom step temp press vol v_pxy v_pxz v_pyz v_v11 v_v22 v_v33 v_Jx v_Jy v_Jz v_k11 v_k22 v_k33
#run          5000000

#variable     v equal (v_v11+v_v22+v_v33)/3.0
#variable     k equal (v_k11+v_k22+v_k33)/3.0
#variable     ndens equal count(all)/vol

#print        "average viscosity: $v [Pa.s] @ $T K, ${ndens} atoms/A^3"
#print        "average conductivity: $k[W/mK] @ $T K, ${ndens} /A\^3"

#unfix nveall
#unfix JJ
#unfix SS



